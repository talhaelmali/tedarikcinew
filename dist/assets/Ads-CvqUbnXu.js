import{g as R,G as q,r as i,J as S,D as h,h as p,j as t,K as y,F as N}from"./index-Pf0wcubd.js";import{A as G}from"./AdCard-BSp87aOX.js";import{d as w}from"./duration-CjPxDxgc.js";const b=R(),U=()=>{const{company:c,loading:m}=q(),[C,E]=i.useState([]),[k,I]=i.useState(!0),[o,P]=i.useState(""),[j,D]=i.useState(""),[a,A]=i.useState(1),[d]=i.useState(5),[x,F]=i.useState(0);i.useEffect(()=>{if(c&&!m){const e=S(h(p(b,"companies")),s=>{const r=[];s.forEach(n=>{if(n.id===c.id)return;const Q=o?h(p(b,"companies",n.id,"ads"),N("title",">=",o),N("title","<=",o+""),y("title"),y("createdAt","desc")):h(p(b,"companies",n.id,"ads"),y("createdAt","desc"));S(Q,B=>{B.forEach(f=>{const l=f.data();l.id=f.id;const J=T(l.createdAt,l.duration);$(J)!=="İlan Süresi Doldu"&&r.push({id:f.id,...l,companyId:n.id})}),L(r)})})});return()=>e()}},[c,o,a,m]);const L=e=>{const s=e.sort((r,n)=>n.createdAt-r.createdAt);F(s.length),E(s.slice((a-1)*d,a*d)),I(!1),localStorage.setItem("ads",JSON.stringify(s))},T=(e,s)=>{if(!e||!s)return null;let r=new Date(e.seconds*1e3);return r.setDate(r.getDate()+parseInt(s)),r},$=e=>{if(!e)return"Bilinmiyor";const s=w(e),r=w(),n=s.diff(r);return n<=0?"İlan Süresi Doldu":`${Math.floor(n/(1e3*60*60*24))} gün`},M=()=>{P(j),A(1)},u=e=>A(e);if(k||m)return t.jsx("div",{children:"Loading..."});const v=a*d,O=v-d,g=Math.ceil(x/d);return t.jsxs("div",{className:"max-w-4xl mx-auto mb-20",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("input",{type:"text",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:border-indigo-500",placeholder:"İlan Ara...",value:j,onChange:e=>D(e.target.value)}),t.jsx("button",{onClick:M,className:"px-4 py-2 bg-[#0D408F] text-white rounded-r-lg",children:"Ara"})]}),t.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[x," ilan arasından ",O+1," - ",Math.min(v,x)," gösteriliyor"]}),t.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"En Son Eklenen İlanlar"}),t.jsx("ul",{role:"list",className:"divide-y divide-gray-200 mt-4",children:C.map(e=>t.jsx(G,{ad:e},`${e.companyId}-${e.id}`))}),g>1&&t.jsxs("nav",{className:"flex items-center justify-between border-t border-gray-200 px-4 sm:px-0 mt-4",children:[t.jsx("div",{className:"-mt-px flex w-0 flex-1",children:t.jsx("button",{onClick:()=>u(a-1),disabled:a===1,className:"inline-flex items-center border-t-2 border-transparent pr-1 pt-4 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700",children:"Önceki"})}),t.jsx("div",{className:"hidden md:-mt-px md:flex",children:Array.from({length:g},(e,s)=>t.jsx("button",{onClick:()=>u(s+1),className:`inline-flex items-center border-t-2 ${a===s+1?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"} px-4 pt-4 text-sm font-medium`,children:s+1},s))}),t.jsx("div",{className:"-mt-px flex w-0 flex-1 justify-end",children:t.jsx("button",{onClick:()=>u(a+1),disabled:a===g,className:"inline-flex items-center border-t-2 border-transparent pl-1 pt-4 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700",children:"Sonraki"})})]})]})};export{U as default};
