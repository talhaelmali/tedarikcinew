import{r as l,u as O,k as z,h as A,I as w,D as B,F as H,i as L,f as R,d as q,j as e,aE as u,aG as U}from"./index-Pf0wcubd.js";import{s as n}from"./sweetalert.min-CUxdrMD-.js";function V(){const[G,v]=l.useState(""),[k,E]=l.useState(""),[x,m]=l.useState([]),[S,h]=l.useState(!0),[C,p]=l.useState(!1),[r,M]=l.useState({name:"",email:"",password:"",role:"",phone:""}),D="profilepic.svg",d=O();l.useEffect(()=>{const s=z.onAuthStateChanged(async t=>{if(t){try{const a=A(w,"companies"),i=B(a,H("adminUserId","==",t.uid)),c=await L(i);if(c.empty)n("Şirket bulunamadı","Bu kullanıcı ile ilişkilendirilmiş bir şirket bulunamadı.","error").then(()=>{d("/dashboard")});else{const f=c.docs[0].data();v(f.companyName||"");const P=c.docs[0].id;E(P);const y=f.teamMembers||[];if(y.length>0){const g=[];for(const j of y){const N=await R(q(w,"users",j.userId));if(N.exists()){const T=N.data();g.push({...T,role:j.role})}}m(g)}else m([])}}catch(a){console.error("Ekip üyeleri alınırken hata oluştu: ",a),n("Hata",a.message,"error")}h(!1)}else h(!1),n("Oturum açılmadı","Ekip üyelerini görüntülemek için giriş yapmalısınız.","error").then(()=>{d("/login")})});return()=>s()},[d]);const I=()=>{p(!0)},b=()=>{p(!1)},o=s=>{const{name:t,value:a}=s.target;M(i=>({...i,[t]:a}))},F=async s=>{s.preventDefault();try{const a=await(await fetch(`${U}/addTeamMember`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,companyId:k})})).json();a.success?(n("Başarılı!","Ekip üyesi başarıyla eklendi.","success"),b(),m(i=>[...i,a.user])):n("Hata",a.message,"error")}catch(t){console.error("Error adding team member:",t),n("Hata","Ekip üyesi eklenirken bir hata oluştu.","error")}};return S?e.jsx("div",{children:"Yükleniyor..."}):e.jsxs("div",{className:"",children:[e.jsxs("nav",{className:"flex border-b border-gray-200 mb-6",children:[e.jsx(u,{to:"/profile",className:({isActive:s})=>s?"text-blue-800 border-b-2 border-blue-800 py-2 px-4":"text-gray-600 py-2 px-4 hover:text-blue-600",children:"Profil"}),e.jsx(u,{to:"/my-company",className:({isActive:s})=>s?"text-blue-800 border-b-2 border-blue-800 py-2 px-4":"text-gray-600 py-2 px-4 hover:text-blue-600",children:"Firma Bilgileri"}),e.jsx(u,{to:"/teammembers",className:({isActive:s})=>s?"text-blue-800 border-b-2 border-blue-800 py-2 px-4":"text-gray-600 py-2 px-4 hover:text-blue-600",children:"Ekip Üyeleri"})]}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Ekip Üyeleri"}),e.jsx("div",{className:"space-y-4",children:x.length>0?x.map((s,t)=>e.jsxs("div",{className:"flex items-center p-4 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{className:"h-12 w-12 rounded-full",src:D,alt:"Profile"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s.fullName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.role})]}),e.jsxs("div",{className:"ml-auto text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:s.email}),e.jsx("p",{className:"text-sm text-gray-600",children:s.phone})]})]},t)):e.jsx("p",{className:"text-gray-600",children:"Bu şirkete ait ekip üyesi bulunmamaktadır."})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{type:"button",className:"py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75",onClick:I,children:"Ekip Üyesi Ekle"})}),C&&e.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsx("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:max-w-lg sm:w-full",children:e.jsx("div",{className:"bg-white px-6 py-5 sm:px-10 sm:py-8",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-5",id:"modal-title",children:"Ekip Üyesi Ekle"}),e.jsx("div",{className:"mt-2",children:e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Ad Soyad"}),e.jsx("input",{type:"text",name:"name",id:"name",className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",value:r.name,onChange:o})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Mesleği"}),e.jsx("input",{type:"text",name:"role",id:"role",className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",value:r.role,onChange:o})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Telefon Numarası"}),e.jsx("input",{type:"text",name:"phone",id:"phone",className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",value:r.phone,onChange:o})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"E-Posta"}),e.jsx("input",{type:"email",name:"email",id:"email",className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",value:r.email,onChange:o}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Kurumsal e-posta adresini giriniz."})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Şifre"}),e.jsx("input",{type:"password",name:"password",id:"password",className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",value:r.password,onChange:o})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-3 sm:px-10 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Ekle"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:b,children:"Vazgeç"})]})]})})]})})})})]})})]})}export{V as default};
